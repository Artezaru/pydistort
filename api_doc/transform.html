
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pydistort.core.Transform &#8212; pydistort 3.2.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=dcedd534"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api_doc/transform';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pydistort.core.TransformInversion" href="transform_inversion.html" />
    <link rel="prev" title="API Reference" href="../api.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pydistort 3.2.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Transformation Classes:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pydistort.core.Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_inversion.html">pydistort.core.TransformInversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_composition.html">pydistort.core.TranformComposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="extrinsic.html">pydistort.core.Extrinsic</a></li>
<li class="toctree-l1"><a class="reference internal" href="intrinsic.html">pydistort.core.Intrinsic</a></li>
<li class="toctree-l1"><a class="reference internal" href="distortion.html">pydistort.core.Distortion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extrinsic and Intrinsic Classes:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="no_intrinsic.html">pydistort.NoIntrinsic</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv2_intrinsic.html">pydistort.Cv2Intrinsic</a></li>
<li class="toctree-l1"><a class="reference internal" href="skew_intrinsic.html">pydistort.SkewIntrinsic</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Distortion Models:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="no_distortion.html">pydistort.NoDistortion</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv2_distortion.html">pydistort.Cv2Distortion</a></li>
<li class="toctree-l1"><a class="reference internal" href="zernike_distortion.html">pydistort.ZernikeDistortion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extrinsic Models:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="no_extrinsic.html">pydistort.NoExtrinsic</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv2_extrinsic.html">pydistort.Cv2Extrinsic</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">(as PYDISTORT):</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="project_points.html">pydistort.project_points</a></li>
<li class="toctree-l1"><a class="reference internal" href="undistort_points.html">pydistort.undistort_points</a></li>
<li class="toctree-l1"><a class="reference internal" href="undistort_image.html">pydistort.undistort_image</a></li>
<li class="toctree-l1"><a class="reference internal" href="distort_image.html">pydistort.distort_image</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">(as OPENCV):</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cv2_project_points.html">pydistort.cv2_project_points</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv2_undistort_points.html">pydistort.cv2_undistort_points</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv2_undistort_image.html">pydistort.cv2_undistort_image</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv2_distort_image.html">pydistort.cv2_distort_image</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">pydistort.core.Transform</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pydistort-core-transform">
<h1>pydistort.core.Transform<a class="headerlink" href="#pydistort-core-transform" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pydistort.core.Transform">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pydistort.core.</span></span><span class="sig-name descname"><span class="pre">Transform</span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Transform is the base class to manage transformations from <span class="math notranslate nohighlight">\(\mathbb{R}^{input\_dim}\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R}^{output\_dim}\)</span>.</p>
<div class="math notranslate nohighlight">
\[X_O = T(X_I, \lambda_1, \lambda_2, \ldots, \lambda_N)\]</div>
<p>where <span class="math notranslate nohighlight">\(X_O\)</span> are the output points, <span class="math notranslate nohighlight">\(X_I\)</span> are the input points, and <span class="math notranslate nohighlight">\(\{\lambda_1, \lambda_2, \ldots, \lambda_N\}\)</span> are the parameters of the transformation.</p>
<p>In this package, the transformations wiil be used to project 3D-world points onto a 2D-image plane in the stenopic camera model.</p>
<p>The process to correspond a 3D-world point to a 2D-image point in the stenopic camera model is as follows:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">world_3dpoints</span></code> (<span class="math notranslate nohighlight">\(X_W\)</span>) are expressed in the camera coordinate system using the rotation and translation matrices to obtain the <code class="docutils literal notranslate"><span class="pre">camera_3dpoints</span></code> (<span class="math notranslate nohighlight">\(X_C\)</span>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">camera_3dpoints</span></code> (<span class="math notranslate nohighlight">\(X_C\)</span>) are normalized by dividing by the third coordinate to obtain the <code class="docutils literal notranslate"><span class="pre">normalized_points</span></code> (<span class="math notranslate nohighlight">\(x_N\)</span>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">normalized_points</span></code> (<span class="math notranslate nohighlight">\(x_N\)</span>) are distorted by the distortion model using the coefficients <span class="math notranslate nohighlight">\(\{\lambda_1, \lambda_2, \lambda_3, \ldots\}\)</span> to obtain the <code class="docutils literal notranslate"><span class="pre">distorted_points</span></code> (<span class="math notranslate nohighlight">\(x_D\)</span>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">distorted_points</span></code> (<span class="math notranslate nohighlight">\(x_D\)</span>) are projected onto the image plane using the intrinsic matrix K to obtain the <code class="docutils literal notranslate"><span class="pre">image_points</span></code> (<span class="math notranslate nohighlight">\(x_I\)</span>).</p></li>
</ol>
<p>This tranformation can be decomposed into 3 main steps:</p>
<ol class="arabic simple">
<li><p><strong>Extrinsic</strong>: Transform the <code class="docutils literal notranslate"><span class="pre">world_3dpoints</span></code> to <code class="docutils literal notranslate"><span class="pre">normalized_points</span></code> using the extrinsic parameters (rotation and translation).</p></li>
<li><p><strong>Distortion</strong>: Transform the <code class="docutils literal notranslate"><span class="pre">normalized_points</span></code> to <code class="docutils literal notranslate"><span class="pre">distorted_points</span></code> using the distortion model.</p></li>
<li><p><strong>Intrinsic</strong>: Transform the <code class="docutils literal notranslate"><span class="pre">distorted_points</span></code> to <code class="docutils literal notranslate"><span class="pre">image_points</span></code> using the intrinsic matrix K.</p></li>
</ol>
<p>This class provides the base for all transformations in the stenopic camera model. It defines the interface for extrinsic, distortion, and intrinsic transformations.</p>
<p>Each sub-classes must implement the following methods and properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input_dim</span></code>: (property) The dimension of the input points (should be 2 for 2D points).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_dim</span></code>: (property) The dimension of the output points (should be 2 for 2D points).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code> (property and setter) The parameters of the transformation in a 1D numpy array of shape (Nparams,).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_set</span></code>: (method) Check if the transformation is set (i.e., if the parameters are initialized).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_transform</span></code>: (method) Apply the transformation to the given points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_inverse_transform</span></code>: (method) Apply the inverse transformation to the given points.</p></li>
</ul>
<p>The following properties are not required but can be implemented to provide additional information about the transformation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">result_class</span></code>: (property) The class used for the result of the transformation (sub-class of <code class="docutils literal notranslate"><span class="pre">TransformResult</span></code>). Default is <a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydistort.core.TransformResult</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_result_class</span></code>: (property) The class used for the result of the inverse transformation (sub-class of <code class="docutils literal notranslate"><span class="pre">TransformResult</span></code>). Default is <a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydistort.core.TransformResult</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_jacobian_short_hand</span></code>: (property) A dictionary of short-hand notation for the Jacobian matrices, which can be used to add custom views of the <code class="docutils literal notranslate"><span class="pre">jacobian_dp</span></code> matrix with respect to the parameters of the transformation.</p></li>
</ul>
<p>More details on the transformation methods are provided in the <cite>transform</cite> and <cite>inverse_transform</cite> methods.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pydistort.core.Transform.transform" title="pydistort.core.Transform.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pydistort.core.Transform.transform()</span></code></a> for applying the transformation to points.</p></li>
<li><p><a class="reference internal" href="#pydistort.core.Transform.inverse_transform" title="pydistort.core.Transform.inverse_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pydistort.core.Transform.inverse_transform()</span></code></a> for applying the inverse transformation to points.</p></li>
<li><p><a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydistort.core.TransformResult</span></code></a> for the result of the transformation.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">...</span></code> in the shape of the attributes indicates that the shape can have any number of leading dimensions, which is useful for batch processing of points.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform.Nparams">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Nparams</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pydistort.core.Transform.Nparams" title="Link to this definition">#</a></dt>
<dd><p>Property to return the number of parameters of the transformation.</p>
<p>The number of parameters must be a non-negative integer representing the number of parameters of the transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of parameters of the transformation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pydistort.core.Transform._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#pydistort.core.Transform._abc_impl" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform._inverse_transform">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform._inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform._inverse_transform" title="Link to this definition">#</a></dt>
<dd><p>Apply the inverse transformation to the given points.</p>
<p>This method must be implemented by subclasses to apply the inverse transformation to the input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The input points to be transformed. Shape (Npoints, output_dim).</p></li>
<li><p><strong>dx</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the input points. Default is False.</p></li>
<li><p><strong>dp</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the parameters of the transformation. Default is False.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing:</p>
<ul class="simple">
<li><p><cite>transformed_points</cite>: The transformed points of shape (Npoints, input_dim).</p></li>
<li><p><cite>jacobian_dx</cite>: The Jacobian matrix with respect to the input points of shape (Npoints, input_dim, output_dim) if <cite>dx</cite> is True, otherwise None.</p></li>
<li><p><cite>jacobian_dp</cite>: The Jacobian matrix with respect to the parameters of the transformation of shape (Npoints, input_dim, Nparams) if <cite>dp</cite> is True, otherwise None.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[numpy.ndarray, Optional[numpy.ndarray], Optional[numpy.ndarray]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform._jacobian_short_hand">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_jacobian_short_hand</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pydistort.core.Transform._jacobian_short_hand" title="Link to this definition">#</a></dt>
<dd><p>Property to return a dictionary of short-hand notation for the Jacobian matrices.</p>
<p>This dictionary can be used to add custom views of the <cite>jacobian_dp</cite> matrix with respect to the parameters of the transformation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;dk&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Custom Jacobian view for two first parameters related to k1 and k2&quot;</span><span class="p">),</span>
    <span class="s2">&quot;dother&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Custom Jacobian view for other parameters related to k3 and k4&quot;</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A dictionary where keys are names of the custom Jacobian views and values are tuples containing:</p>
<ul class="simple">
<li><p>start index (int): The starting index of the parameters to include in the custom Jacobian view.</p></li>
<li><p>end index (int): The ending index of the parameters to include in the custom Jacobian view.</p></li>
<li><p>doc (Optional[str]): A documentation string for the custom Jacobian view.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, Tuple[int, int, Optional[str]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform._transform">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform._transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform._transform" title="Link to this definition">#</a></dt>
<dd><p>Apply the transformation to the given points.</p>
<p>This method must be implemented by subclasses to apply the transformation to the input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The input points to be transformed. Shape (Npoints, input_dim).</p></li>
<li><p><strong>dx</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the input points. Default is False.</p></li>
<li><p><strong>dp</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the parameters of the transformation. Default is False.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple containing:</p>
<ul class="simple">
<li><p><cite>transformed_points</cite>: The transformed points of shape (Npoints, output_dim).</p></li>
<li><p><cite>jacobian_dx</cite>: The Jacobian matrix with respect to the input points of shape (Npoints, output_dim, input_dim) if <cite>dx</cite> is True, otherwise None.</p></li>
<li><p><cite>jacobian_dp</cite>: The Jacobian matrix with respect to the parameters of the transformation of shape (Npoints, output_dim, Nparams) if <cite>dp</cite> is True, otherwise None.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[numpy.ndarray, Optional[numpy.ndarray], Optional[numpy.ndarray]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform.input_dim">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pydistort.core.Transform.input_dim" title="Link to this definition">#</a></dt>
<dd><p>Property to return the input dimension of the transformation.</p>
<p>The input dimension must be a positive integer representing the number of dimensions of the input points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of dimensions of the input points.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform.inverse_result_class">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">inverse_result_class</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">type</span></em><a class="headerlink" href="#pydistort.core.Transform.inverse_result_class" title="Link to this definition">#</a></dt>
<dd><p>Property to return the class used for the result of the inverse transformation.</p>
<p>The default is <cite>TransformResult</cite>, but subclasses can override this to return a different class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The class used for the result of the inverse transformation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform.inverse_transform" title="Link to this definition">#</a></dt>
<dd><p>The given points <code class="docutils literal notranslate"><span class="pre">points</span></code> are assumed to be with shape (…, output_dim) or (output_dim, …), depending on the value of <code class="docutils literal notranslate"><span class="pre">transpose</span></code>.</p>
<p>The output <code class="docutils literal notranslate"><span class="pre">transformed_points</span></code> will have shape (…, input_dim) if <code class="docutils literal notranslate"><span class="pre">transpose</span></code> is False, or (input_dim, …) if <code class="docutils literal notranslate"><span class="pre">transpose</span></code> is True.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The points are converting to float64 before applying the inverse transformation.</p>
</div>
<p>The method also computes 2 Jacobian matrices if requested:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code>: Jacobian of the transformed points with respect to the input points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dp</span></code>: Jacobian of the transformed points with respect to the parameters of the transformation.</p></li>
</ul>
<p>The jacobian matrice with respect to the input points is a (…, input_dim, output_dim) matrix where:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂x_i/∂x_o -&gt; Jacobian of the coordinates x_i with respect to the coordinates x_o.</span>
<span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂x_i/∂y_o</span>
<span class="o">...</span>

<span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂y_i/∂x_o -&gt; Jacobian of the coordinates y_i with respect to the coordinates x_o.</span>
<span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂y_i/∂y_o</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The Jacobian matrice with respect to the parameters is a (…, input_dim, Nparams) matrix where:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂x_i/∂λ_1 -&gt; Jacobian of the coordinates x_i with respect to the first parameter λ_1.</span>
<span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂x_i/∂λ_2</span>
<span class="o">...</span>

<span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂y_i/∂λ_1 -&gt; Jacobian of the coordinates y_i with respect to the first parameter λ_1.</span>
<span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂y_i/∂λ_2</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The Jacobian matrices are computed only if <code class="docutils literal notranslate"><span class="pre">dx</span></code> or <code class="docutils literal notranslate"><span class="pre">dp</span></code> are set to True, respectively.</p>
<p>The output will be a <cite>TransformResult</cite> object containing the transformed points and the Jacobian matrices if requested.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The _skip parameter is used to skip the checks for the transformation parameters and assume the points are given in the (Npoints, output_dim) float64 format.
Please use this parameter with caution, as it may lead to unexpected results if the transformation parameters are not set correctly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The input points to be transformed. Shape (…, output_dim) (or (output_dim, …) if <cite>transpose</cite> is True).</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the input points are transposed to shape (output_dim, …). Default is False.</p></li>
<li><p><strong>dx</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the input points. Default is False.</p></li>
<li><p><strong>dp</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the parameters of the transformation. Default is False.</p></li>
<li><p><strong>_skip</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, skip the checks for the transformation parameters and assume the points are given in the (Npoints, output_dim) float64 format.
<cite>transpose</cite> is ignored if this parameter is set to True.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object containing the transformed points and the Jacobian matrices if requested.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult">TransformResult</a></p>
</dd>
</dl>
<section id="developer-notes">
<h2>Developer Notes<a class="headerlink" href="#developer-notes" title="Link to this heading">#</a></h2>
<p>The subclasses must implement the <cite>_inverse_transform</cite> method to apply the inverse transformation to the input points.</p>
<p>The <cite>_inverse_transform</cite> method should:</p>
<ul>
<li><p>take the input points as a numpy array of shape (Npoints, output_dim)</p></li>
<li><p>return 3 numpy arrays:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>transformed_points</cite>: The transformed points of shape (Npoints, input_dim).</p></li>
<li><p><cite>jacobian_dx</cite>: The Jacobian matrix with respect to the input points of shape (Npoints, input_dim, output_dim) if <cite>dx</cite> is True, otherwise None.</p></li>
<li><p><cite>jacobian_dp</cite>: The Jacobian matrix with respect to the parameters of the transformation of shape (Npoints, input_dim, Nparams) if <cite>dp</cite> is True, otherwise None.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform.is_set">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform.is_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform.is_set" title="Link to this definition">#</a></dt>
<dd><p>Method to check if the transformation parameters are set.</p>
<p>This method should return True if the transformation parameters are initialized, otherwise False.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the transformation parameters are set, otherwise False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform.optimize_input_points">
<span class="sig-name descname"><span class="pre">optimize_input_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform.optimize_input_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform.optimize_input_points" title="Link to this definition">#</a></dt>
<dd><p>Optimize the input points of the transformation using the given output points.</p>
<p>Estimate the optimized input points of the transformation such that the transformed input points match the output points.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method can only be used if the dimensions are the same, i.e. input_dim == dim.</p>
</div>
<p>Lets consider a set of output points <span class="math notranslate nohighlight">\(X_O\)</span> with shape (…, dim) and a set of input points <span class="math notranslate nohighlight">\(X_I\)</span> with shape (…, input_dim).
We search <span class="math notranslate nohighlight">\(X_I = X_{I0} + \delta X_I\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[X_O = \text{Transform}(X_I, \lambda) = T(X_I + \delta X_I, \lambda)\]</div>
<p>We have:</p>
<div class="math notranslate nohighlight">
\[\nabla_{X} T (X_I, \lambda_0) \delta \lambda = X_O - T(X_I, \lambda_0)\]</div>
<p>The corrections are computed using the following equations:</p>
<div class="math notranslate nohighlight">
\[J \delta X_I = R\]</div>
<p>Where <span class="math notranslate nohighlight">\(J = \nabla_{X} T (X_I, \lambda_0)\)</span> is the Jacobian matrix of the transformation with respect to the input points, and <span class="math notranslate nohighlight">\(R = X_O - T(X_I, \lambda_0)\)</span> is the residual vector.</p>
<p><span class="math notranslate nohighlight">\(X_{I0}\)</span> is the initial guess for the input points, if None, it use the output points as the initial guess.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_skip</span></code> parameter is used to skip the checks for the transformation parameters and assume the output points are given in the (Npoints, dim) float64 format.
Please use this parameter with caution, as it may lead to unexpected results if the transformation parameters are not set correctly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_points</strong> (<em>numpy.ndarray</em>) – The output points to be matched. Shape (…, dim) (or (dim, …) if <cite>transpose</cite> is True).</p></li>
<li><p><strong>guess</strong> (<em>Optional</em><em>[</em><em>numpy.ndarray</em><em>]</em><em>, </em><em>optional</em>) – The initial guess for the input points of the transformation with shape (…, dim). If None, the output points are used as the initial guess. Default is None.</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the output points are transposed to shape (dim, …). Default is False.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations for the optimization. Default is 10.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – The convergence threshold for the optimization. Default is 1e-8.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, print the optimization progress and diagnostics. Default is False.</p></li>
<li><p><strong>_skip</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, skip the checks for the transformation parameters and assume the output points are given in the (Npoints, dim) float64 format.
The guess must be given in the (Npoints, dim) float64 format.
<cite>transpose</cite> is ignored if this parameter is set to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimized input points of the transformation with shape (…, dim).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the output points do not have the expected shape, or if the input and output dimensions do not match the transformation’s input and output dimensions.</p></li>
<li><p><strong>TypeError</strong> – If the output points or guess are not numpy arrays, or if the guess is not a numpy array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform.optimize_parameters">
<span class="sig-name descname"><span class="pre">optimize_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cond_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precond_jacobi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_verbose_eigen</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform.optimize_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform.optimize_parameters" title="Link to this definition">#</a></dt>
<dd><p>Optimize the parameters of the transformation using the given input and output points.</p>
<p>Estimate the optimized parameters of the transformation such that the transformed input points match the output points.</p>
<p>Lets consider a set of input points <span class="math notranslate nohighlight">\(X_I\)</span> with shape (…, input_dim) and a set of output points <span class="math notranslate nohighlight">\(X_O\)</span> with shape (…, output_dim).
We search <span class="math notranslate nohighlight">\(\lambda = \lambda_0 + \delta \lambda\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[X_O = \text{Transform}(X_I, \lambda) = T(X_I, \lambda_0 + \delta \lambda)\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The current parameters of the transformation are not directly modified.</p>
</div>
<p>We have:</p>
<div class="math notranslate nohighlight">
\[\nabla_{\lambda} T (X_I, \lambda_0) \delta \lambda = X_O - T(X_I, \lambda_0)\]</div>
<p>The corrections are computed using the following equations:</p>
<div class="math notranslate nohighlight">
\[J^{T} J \delta \lambda = J^{T} R\]</div>
<p>Where <span class="math notranslate nohighlight">\(J = \nabla_{\lambda} T (X_I, \lambda_0)\)</span> is the Jacobian matrix of the transformation with respect to the parameters, and <span class="math notranslate nohighlight">\(R = X_O - T(X_I, \lambda_0)\)</span> is the residual vector.</p>
<p><span class="math notranslate nohighlight">\(\lambda_0\)</span> is the initial guess for the parameters, if None, the current parameters of the transformation are used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method can be used to optimize the parameters of any transformation that implements the <cite>_transform</cite> method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_skip</span></code> parameter is used to skip the checks for the transformation parameters and assume the input and output points are given in the (Npoints, input_dim) and (Npoints, output_dim) float64 format, respectively.
Please use this parameter with caution, as it may lead to unexpected results if the transformation parameters are not set correctly.</p>
</div>
<p>For conditioning, the following steps are applied:</p>
<ul class="simple">
<li><p>First, a regularization term is added to the Jacobian matrix to improve stability: <span class="math notranslate nohighlight">\(J^{T} J + \text{regfactor} I\)</span>.</p></li>
<li><p>Second, a preconditioner is applied to the Jacobian matrix to improve the conditioning of the problem.</p></li>
</ul>
<p>The <cite>cond_cutoff</cite> parameter is used to detect ill-conditioned problems. If the condition number of the Jacobian matrix is greater than this value, a warning is raised and the optimization returns NaN array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_points</strong> (<em>numpy.ndarray</em>) – The input points to be transformed. Shape (…, input_dim) (or (input_dim, …) if <cite>transpose</cite> is True).</p></li>
<li><p><strong>output_points</strong> (<em>numpy.ndarray</em>) – The output points to be matched. Shape (…, output_dim) (or (output_dim, …) if <cite>transpose</cite> is True).</p></li>
<li><p><strong>guess</strong> (<em>Optional</em><em>[</em><em>numpy.ndarray</em><em>]</em><em>, </em><em>optional</em>) – The initial guess for the parameters of the transformation with shape (Nparams,). If None, the current parameters of the transformation are used. Default is None.</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the input and output points are transposed to shape (input_dim, …) and (output_dim, …), respectively. Default is False.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of iterations for the optimization. Default is 10.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – The convergence threshold for the optimization. Default is 1e-8.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, print the optimization progress and diagnostics. Default is False.</p></li>
<li><p><strong>cond_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – The cutoff value for the condition number of the Jacobian matrix. If the condition number is greater than this value, the optimization will be considered unstable and will raise a warning and return NaN array. This is used to detect ill-conditioned problems. Default is 1e5.</p></li>
<li><p><strong>reg_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The regularization factor for the optimization. If greater than 0, it adds a tikhonov regularization term to the optimization problem to improve stability <span class="math notranslate nohighlight">\(J^{T} J + \text{regfactor} I\)</span>. Default is 0.0.</p></li>
<li><p><strong>precond_jacobi</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, apply a preconditioner to the Jacobian matrix to improve the conditioning of the problem. This is done by applying the Jacobi preconditioner to the Jacobian matrix before solving the optimization problem. Default is False.</p></li>
<li><p><strong>_skip</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, skip the checks for the transformation parameters and assume the input and output points are given in the (Npoints, input_dim) and (Npoints, output_dim) float64 format, respectively.
The guess must be given in the (Nparams,) float64 format.
<cite>transpose</cite> is ignored if this parameter is set to True.</p></li>
<li><p><strong>_verbose_eigen</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, display the eigenvalues of the Jacobian matrix during the optimization process. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimized parameters of the transformation with shape (Nparams,).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the input and output points do not have the same number of points, or if the input and output dimensions do not match the transformation’s input and output dimensions.</p></li>
<li><p><strong>TypeError</strong> – If the input and output points are not numpy arrays, or if the guess is not a numpy array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform.output_dim">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#pydistort.core.Transform.output_dim" title="Link to this definition">#</a></dt>
<dd><p>Property to return the output dimension of the transformation.</p>
<p>The output dimension must be a positive integer representing the number of dimensions of the output points.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of dimensions of the output points.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform.parameters">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pydistort.core.Transform.parameters" title="Link to this definition">#</a></dt>
<dd><p>Property to return the parameters of the transformation.</p>
<p>The parameters must be a 1-D numpy array of shape (Nparams,) where Nparams is the number of parameters of the transformation.</p>
<p>If the transformation does not have parameters or they are not set, this property should return None.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The parameters of the transformation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[numpy.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pydistort.core.Transform.result_class">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">result_class</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">type</span></em><a class="headerlink" href="#pydistort.core.Transform.result_class" title="Link to this definition">#</a></dt>
<dd><p>Property to return the class used for the result of the transformation.</p>
<p>The default is <cite>TransformResult</cite>, but subclasses can override this to return a different class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The class used for the result of the transformation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform.return_result">
<span class="sig-name descname"><span class="pre">return_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.transform.TransformResult"><span class="pre">TransformResult</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.transform.TransformResult"><span class="pre">TransformResult</span></a></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform.return_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform.return_result" title="Link to this definition">#</a></dt>
<dd><p>Return the result of the transformation as a <code class="docutils literal notranslate"><span class="pre">TransformResult</span></code> object.</p>
<p>This method is used to return the result of the transformation, including the transformed points and the Jacobian matrices if requested.</p>
<p>This medthos also add the custom Jacobian views to the <cite>TransformResult</cite> object using the <cite>add_jacobian</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transform_result</strong> (<a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult"><em>TransformResult</em></a>) – The result of the transformation containing the transformed points and the Jacobian matrices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the transformation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult">TransformResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.Transform.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_skip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#Transform.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.Transform.transform" title="Link to this definition">#</a></dt>
<dd><p>The given points <code class="docutils literal notranslate"><span class="pre">points</span></code> are assumed to be with shape (…, input_dim) or (input_dim, …), depending on the value of <code class="docutils literal notranslate"><span class="pre">transpose</span></code>.</p>
<p>The output <code class="docutils literal notranslate"><span class="pre">transformed_points</span></code> will have shape (…, output_dim) if <code class="docutils literal notranslate"><span class="pre">transpose</span></code> is False, or (output_dim, …) if <code class="docutils literal notranslate"><span class="pre">transpose</span></code> is True.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The points are converting to float64 before applying the transformation.</p>
</div>
<p>The method also computes 2 Jacobian matrices if requested:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code>: Jacobian of the transformed points with respect to the input points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dp</span></code>: Jacobian of the transformed points with respect to the parameters of the transformation.</p></li>
</ul>
<p>The jacobian matrice with respect to the input points is a (…, output_dim, input_dim) matrix where:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂x_o/∂x_i -&gt; Jacobian of the coordinates x_o with respect to the coordinates x_i.</span>
<span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂x_o/∂y_i</span>
<span class="o">...</span>

<span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂y_o/∂x_i -&gt; Jacobian of the coordinates y_o with respect to the coordinates x_i.</span>
<span class="n">jacobian_dx</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂y_o/∂y_i</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The Jacobian matrice with respect to the parameters is a (…, output_dim, Nparams) matrix where:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂x_o/∂λ_1 -&gt; Jacobian of the coordinates x_o with respect to the first parameter λ_1.</span>
<span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂x_o/∂λ_2</span>
<span class="o">...</span>

<span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ∂y_o/∂λ_1 -&gt; Jacobian of the coordinates y_o with respect to the first parameter λ_1.</span>
<span class="n">jacobian_dp</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ∂y_o/∂λ_2</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The Jacobian matrices are computed only if <code class="docutils literal notranslate"><span class="pre">dx</span></code> or <code class="docutils literal notranslate"><span class="pre">dp</span></code> are set to True, respectively.</p>
<p>The output will be a <cite>TransformResult</cite> object containing the transformed points and the Jacobian matrices if requested.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The _skip parameter is used to skip the checks for the transformation parameters and assume the points are given in the (Npoints, input_dim) float64 format.
Please use this parameter with caution, as it may lead to unexpected results if the transformation parameters are not set correctly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<em>numpy.ndarray</em>) – The input points to be transformed. Shape (…, input_dim) (or (input_dim, …) if <cite>transpose</cite> is True).</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the input points are transposed to shape (input_dim, …). Default is False.</p></li>
<li><p><strong>dx</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the input points. Default is False.</p></li>
<li><p><strong>dp</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, compute the Jacobian of the transformed points with respect to the parameters of the transformation. Default is False.</p></li>
<li><p><strong>_skip</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, skip the checks for the transformation parameters and assume the points are given in the (Npoints, input_dim) float64 format.
<cite>transpose</cite> is ignored if this parameter is set to True.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the transformation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object containing the transformed points and the Jacobian matrices if requested.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pydistort.core.TransformResult" title="pydistort.core.TransformResult">TransformResult</a></p>
</dd>
</dl>
<section id="id1">
<h2>Developer Notes<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>The subclasses must implement the <cite>_transform</cite> method to apply the transformation to the input points.</p>
<p>The <cite>_transform</cite> method should:</p>
<ul>
<li><p>take the input points as a numpy array of shape (Npoints, input_dim)</p></li>
<li><p>return 3 numpy arrays:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>transformed_points</cite>: The transformed points of shape (Npoints, output_dim).</p></li>
<li><p><cite>jacobian_dx</cite>: The Jacobian matrix with respect to the input points of shape (Npoints, output_dim, input_dim) if <cite>dx</cite> is True, otherwise None.</p></li>
<li><p><cite>jacobian_dp</cite>: The Jacobian matrix with respect to the parameters of the transformation of shape (Npoints, output_dim, Nparams) if <cite>dp</cite> is True, otherwise None.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pydistort.core.TransformResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pydistort.core.</span></span><span class="sig-name descname"><span class="pre">TransformResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transformed_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacobian_dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jacobian_dp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pydistort/core/transform.html#TransformResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.TransformResult" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to represent the result of a transformation.</p>
<p>This class is used to store the results of a transformation, including the transformed points and the Jacobian matrices.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pydistort.core.Transform" title="pydistort.core.Transform"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydistort.core.Transform</span></code></a> for the base class of all transformations.</p></li>
<li><p><a class="reference internal" href="#pydistort.core.Transform.transform" title="pydistort.core.Transform.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pydistort.core.Transform.transform()</span></code></a> for applying the transformation to points.</p></li>
<li><p><a class="reference internal" href="#pydistort.core.Transform.inverse_transform" title="pydistort.core.Transform.inverse_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pydistort.core.Transform.inverse_transform()</span></code></a> for applying the inverse transformation to points (<cite>output_dim</cite> and <cite>input_dim</cite> are swapped).</p></li>
</ul>
</div>
<p>For a transformation from <span class="math notranslate nohighlight">\(\mathbb{R}^{input\_dim}\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R}^{output\_dim}\)</span>, the input points are assumed to have shape (…, input_dim) and the output points will have shape (…, output_dim).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">transpose</span></code> is set to True during the transformation, the output points will have shape (output_dim, …) instead of (…, output_dim), same for the Jacobian matrices.</p>
</div>
<p>Some short-hand notation for the Jacobian matrices can be added to the <cite>TransformResult</cite> class usaing the <cite>add_jacobian</cite> method, which allows to add custom views of the <code class="docutils literal notranslate"><span class="pre">dp</span></code> Jacobian matrix with respect to the parameters of the transformation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">TransformResult</span><span class="p">(</span><span class="n">transformed_points</span><span class="p">,</span> <span class="n">jacobian_dx</span><span class="p">,</span> <span class="n">jacobian_dp</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">add_jacobian</span><span class="p">(</span><span class="s2">&quot;dk&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Custom Jacobian view for two first parameters related to k1 and k2&quot;</span><span class="p">)</span>

<span class="n">result</span><span class="o">.</span><span class="n">jacobian_dk</span> <span class="c1"># This will return a view of the jacobian_dp matrix with respect to the parameters k1 and k2, i.e., jacobian_dp[..., 0:2]</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="pydistort.core.TransformResult.transformed_points">
<span class="sig-name descname"><span class="pre">transformed_points</span></span><a class="headerlink" href="#pydistort.core.TransformResult.transformed_points" title="Link to this definition">#</a></dt>
<dd><p>The transformed points after applying the transformation.
Shape (…, output_dim).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pydistort.core.TransformResult.jacobian_dx">
<span class="sig-name descname"><span class="pre">jacobian_dx</span></span><a class="headerlink" href="#pydistort.core.TransformResult.jacobian_dx" title="Link to this definition">#</a></dt>
<dd><p>The Jacobian matrix with respect to the input points.
Shape (…, output_dim, input_dim).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[numpy.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pydistort.core.TransformResult.jacobian_dp">
<span class="sig-name descname"><span class="pre">jacobian_dp</span></span><a class="headerlink" href="#pydistort.core.TransformResult.jacobian_dp" title="Link to this definition">#</a></dt>
<dd><p>The Jacobian matrix with respect to the parameters of the transformation.
Shape (…, output_dim, Nparams).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[numpy.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.TransformResult.add_jacobian">
<span class="sig-name descname"><span class="pre">add_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/pydistort/core/transform.html#TransformResult.add_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.TransformResult.add_jacobian" title="Link to this definition">#</a></dt>
<dd><p>Add a custom view of the <cite>jacobian_dp</cite> matrix to the <cite>TransformResult</cite> object.</p>
<p>This method allows to add custom views of the <cite>jacobian_dp</cite> matrix with respect to the parameters of the transformation.
The custom Jacobian can be accessed using the <cite>name</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the custom Jacobian view.</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting index of the parameters to include in the custom Jacobian view.</p></li>
<li><p><strong>end</strong> (<em>int</em>) – The ending index of the parameters to include in the custom Jacobian view.</p></li>
<li><p><strong>doc</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – A documentation string for the custom Jacobian view. Default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pydistort.core.TransformResult.describe_jacobians">
<span class="sig-name descname"><span class="pre">describe_jacobians</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pydistort/core/transform.html#TransformResult.describe_jacobians"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pydistort.core.TransformResult.describe_jacobians" title="Link to this definition">#</a></dt>
<dd><p>Print the descriptions of the custom Jacobian views.</p>
<p>This method prints the names and documentation strings of the custom Jacobian views added to the <cite>TransformResult</cite> object.</p>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../api.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">API Reference</p>
      </div>
    </a>
    <a class="right-next"
       href="transform_inversion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">pydistort.core.TransformInversion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform"><code class="docutils literal notranslate"><span class="pre">Transform</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.Nparams"><code class="docutils literal notranslate"><span class="pre">Transform.Nparams</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform._abc_impl"><code class="docutils literal notranslate"><span class="pre">Transform._abc_impl</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform._inverse_transform"><code class="docutils literal notranslate"><span class="pre">Transform._inverse_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform._jacobian_short_hand"><code class="docutils literal notranslate"><span class="pre">Transform._jacobian_short_hand</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform._transform"><code class="docutils literal notranslate"><span class="pre">Transform._transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.input_dim"><code class="docutils literal notranslate"><span class="pre">Transform.input_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.inverse_result_class"><code class="docutils literal notranslate"><span class="pre">Transform.inverse_result_class</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.inverse_transform"><code class="docutils literal notranslate"><span class="pre">Transform.inverse_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.is_set"><code class="docutils literal notranslate"><span class="pre">Transform.is_set()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.optimize_input_points"><code class="docutils literal notranslate"><span class="pre">Transform.optimize_input_points()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.optimize_parameters"><code class="docutils literal notranslate"><span class="pre">Transform.optimize_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.output_dim"><code class="docutils literal notranslate"><span class="pre">Transform.output_dim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.parameters"><code class="docutils literal notranslate"><span class="pre">Transform.parameters</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.result_class"><code class="docutils literal notranslate"><span class="pre">Transform.result_class</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.return_result"><code class="docutils literal notranslate"><span class="pre">Transform.return_result()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.Transform.transform"><code class="docutils literal notranslate"><span class="pre">Transform.transform()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.TransformResult"><code class="docutils literal notranslate"><span class="pre">TransformResult</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.TransformResult.transformed_points"><code class="docutils literal notranslate"><span class="pre">TransformResult.transformed_points</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.TransformResult.jacobian_dx"><code class="docutils literal notranslate"><span class="pre">TransformResult.jacobian_dx</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.TransformResult.jacobian_dp"><code class="docutils literal notranslate"><span class="pre">TransformResult.jacobian_dp</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.TransformResult.add_jacobian"><code class="docutils literal notranslate"><span class="pre">TransformResult.add_jacobian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pydistort.core.TransformResult.describe_jacobians"><code class="docutils literal notranslate"><span class="pre">TransformResult.describe_jacobians()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api_doc/transform.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025-%Y, Artezaru.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>